# AIå€™é€‰äººBFF (Backend For Frontend)

ä¸€ä¸ªåŸºäºExpress.jsçš„æ™ºèƒ½å€™é€‰äººä¿¡æ¯æœåŠ¡ï¼Œé›†æˆäº†MCP (Model Context Protocol) æœåŠ¡å™¨å’ŒLangFuseç›‘æ§ï¼Œä¸ºAIé©±åŠ¨çš„æ‹›è˜åŠ©æ‰‹æä¾›åç«¯æ”¯æŒã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¤– **é›†æˆMCPæœåŠ¡å™¨**: ç›´æ¥é›†æˆå€™é€‰äººä¿¡æ¯MCPæœåŠ¡å™¨ï¼Œæ— å¤–éƒ¨ä¾èµ–
- ğŸ“Š **LangFuseç›‘æ§**: å®Œæ•´çš„APIè°ƒç”¨è¿½è¸ªå’Œæ€§èƒ½ç›‘æ§
- ğŸ”§ **é…ç½®åŒ–ç®¡ç†**: å€™é€‰äººä¿¡æ¯é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†ï¼Œæ˜“äºæ›´æ–°
- ğŸš€ **å¤šå¹³å°éƒ¨ç½²**: æ”¯æŒVercelã€Railwayã€Dockerç­‰å¤šç§éƒ¨ç½²æ–¹å¼
- ğŸ’¬ **æ™ºèƒ½å¯¹è¯**: åŸºäºOpenAI GPTæ¨¡å‹çš„æ™ºèƒ½å€™é€‰äººä¿¡æ¯é—®ç­”
- ğŸ›¡ï¸ **ç”Ÿäº§å°±ç»ª**: åŒ…å«å¥åº·æ£€æŸ¥ã€é”™è¯¯å¤„ç†ã€å®‰å…¨é…ç½®

## ğŸ—ï¸ æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ç•Œé¢      â”‚â”€â”€â”€â”€â”‚  AIå€™é€‰äººBFF     â”‚â”€â”€â”€â”€â”‚   OpenAI API    â”‚
â”‚   (Web UI)      â”‚    â”‚  (Express.js)    â”‚    â”‚   (GPTæ¨¡å‹)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”œâ”€â”€ é›†æˆMCPæœåŠ¡å™¨
                              â”œâ”€â”€ LangFuseç›‘æ§
                              â””â”€â”€ å€™é€‰äººé…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 18+
- npm æˆ– yarn
- OpenAI APIå¯†é’¥
- LangFuseè´¦æˆ·ï¼ˆå¯é€‰ï¼Œç”¨äºç›‘æ§ï¼‰

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd ai-candidate-bff
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   cp .env.production .env
   # ç¼–è¾‘.envæ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„APIå¯†é’¥
   ```

4. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

5. **è®¿é—®åº”ç”¨**
   - åº”ç”¨: http://localhost:3000
   - å¥åº·æ£€æŸ¥: http://localhost:3000/health
   - ç›‘æ§çŠ¶æ€: http://localhost:3000/monitoring

## ğŸ“‹ APIç«¯ç‚¹

### æ ¸å¿ƒç«¯ç‚¹

- `GET /` - å‰ç«¯ç•Œé¢
- `GET /health` - å¥åº·æ£€æŸ¥
- `GET /monitoring` - ç›‘æ§çŠ¶æ€
- `POST /chat` - æ™ºèƒ½å¯¹è¯API
- `POST /mcp` - MCPåè®®ç«¯ç‚¹

### æµ‹è¯•ç«¯ç‚¹

- `GET /test-mcp/resume-text` - è·å–ç®€å†æ–‡æœ¬
- `GET /test-mcp/linkedin-url` - è·å–LinkedIné“¾æ¥
- `GET /test-mcp/github-url` - è·å–GitHubé“¾æ¥

## ğŸ”§ é…ç½®

### å€™é€‰äººä¿¡æ¯é…ç½®

å€™é€‰äººä¿¡æ¯é€šè¿‡é…ç½®æ–‡ä»¶ç®¡ç†ï¼Œä½äº `config/` ç›®å½•ï¼š

- `config/candidate.js` - å€™é€‰äººåŸºæœ¬ä¿¡æ¯
- `config/resume-content.js` - è¯¦ç»†ç®€å†å†…å®¹
- `config/server.js` - æœåŠ¡å™¨é…ç½®

### ç¯å¢ƒå˜é‡

```bash
# å¿…éœ€é…ç½®
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4.1-nano

# LangFuseç›‘æ§ï¼ˆå¯é€‰ï¼‰
LANGFUSE_PUBLIC_KEY=your_langfuse_public_key_here
LANGFUSE_SECRET_KEY=your_langfuse_secret_key_here
LANGFUSE_BASE_URL=https://cloud.langfuse.com

# åº”ç”¨é…ç½®
NODE_ENV=production
PORT=3000
```

## ğŸš€ éƒ¨ç½²

é¡¹ç›®æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼Œè¯¦è§ [DEPLOYMENT.md](./DEPLOYMENT.md)ï¼š

### æ¨èéƒ¨ç½²å¹³å°

1. **Vercel** (æ¨è) - è‡ªåŠ¨éƒ¨ç½²ã€å…¨çƒCDNã€å…è´¹é¢åº¦
2. **Railway** - ç®€å•å®¹å™¨åŒ–éƒ¨ç½²ã€æ”¯æŒæ•°æ®åº“
3. **Docker** - é€‚åˆè‡ªå»ºæœåŠ¡å™¨
4. **ä¼ ç»ŸVPS** - ä½¿ç”¨PM2è¿›ç¨‹ç®¡ç†

### å¿«é€Ÿéƒ¨ç½²åˆ°Vercel

1. æ¨é€ä»£ç åˆ°GitHub
2. åœ¨Vercelä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. è‡ªåŠ¨éƒ¨ç½²å®Œæˆ

## ğŸ“Š ç›‘æ§

### LangFuseç›‘æ§

é›†æˆäº†LangFuseç›‘æ§ï¼Œå¯ä»¥è¿½è¸ªï¼š
- APIè°ƒç”¨ç»Ÿè®¡
- Tokenä½¿ç”¨æƒ…å†µ
- é”™è¯¯æ—¥å¿—
- æ€§èƒ½æŒ‡æ ‡

è®¿é—® [LangFuse Dashboard](https://cloud.langfuse.com) æŸ¥çœ‹è¯¦ç»†ç›‘æ§æ•°æ®ã€‚

### å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥åº”ç”¨çŠ¶æ€
curl http://localhost:3000/health

# æ£€æŸ¥ç›‘æ§çŠ¶æ€
curl http://localhost:3000/monitoring
```

## ğŸ› ï¸ å¼€å‘

### é¡¹ç›®ç»“æ„

```
ai-candidate-bff/
â”œâ”€â”€ index.js                 # ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ llmService.js            # LLMæœåŠ¡
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ mcp-server/          # é›†æˆçš„MCPæœåŠ¡å™¨
â”‚   â””â”€â”€ services/            # æœåŠ¡å±‚
â”œâ”€â”€ config/                  # é…ç½®æ–‡ä»¶
â”œâ”€â”€ public/                  # é™æ€æ–‡ä»¶
â”œâ”€â”€ scripts/                 # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ tests/               # æµ‹è¯•è„šæœ¬é›†åˆ
â”‚   â”œâ”€â”€ deploy-check.sh      # éƒ¨ç½²æ£€æŸ¥
â”‚   â”œâ”€â”€ start-production.sh  # ç”Ÿäº§å¯åŠ¨
â”‚   â””â”€â”€ verify-deployment.sh # éƒ¨ç½²éªŒè¯
â””â”€â”€ docs/                    # æ–‡æ¡£
```

### å¯ç”¨è„šæœ¬

```bash
npm run dev          # å¼€å‘æ¨¡å¼
npm run start        # ç”Ÿäº§æ¨¡å¼å¯åŠ¨
npm run start:prod   # ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
npm run health-check # å¥åº·æ£€æŸ¥
```

### æµ‹è¯•è„šæœ¬

æ‰€æœ‰æµ‹è¯•å’Œè°ƒè¯•è„šæœ¬å·²ç§»åŠ¨åˆ° `scripts/tests/` ç›®å½•ï¼Œè¯¦è§ [scripts/tests/README.md](./scripts/tests/README.md)ï¼š

```bash
# å¿«é€ŸéªŒè¯
node scripts/tests/quick-status-check.js
node scripts/tests/test-live-query.js

# æ·±åº¦è°ƒè¯•
node scripts/tests/debug-tool-selection.js
node scripts/tests/test-mcp-tools-step-by-step.js

# ç¯å¢ƒéªŒè¯
node scripts/tests/test-env-vars.js
node scripts/tests/test-openai.js
```

### æ›´æ–°å€™é€‰äººä¿¡æ¯

1. ç¼–è¾‘ `config/candidate.js` å’Œ `config/resume-content.js`
2. é‡å¯åº”ç”¨æˆ–é‡æ–°éƒ¨ç½²
3. éªŒè¯æ›´æ–°æ˜¯å¦ç”Ÿæ•ˆ

## ğŸ”’ å®‰å…¨

- ç¯å¢ƒå˜é‡å®‰å…¨å­˜å‚¨
- CORSé…ç½®
- érootç”¨æˆ·è¿è¡Œï¼ˆDockerï¼‰
- APIå¯†é’¥éªŒè¯ï¼ˆå¯é€‰ï¼‰

## ğŸ¤ è´¡çŒ®

1. Forké¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»ºPull Request

## ğŸ“„ è®¸å¯è¯

ISC License

## ğŸ†˜ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ [DEPLOYMENT.md](./DEPLOYMENT.md) éƒ¨ç½²æŒ‡å—
2. æ£€æŸ¥ [æ•…éšœæ’é™¤](./DEPLOYMENT.md#æ•…éšœæ’é™¤) éƒ¨åˆ†
3. æŸ¥çœ‹åº”ç”¨æ—¥å¿—
4. æäº¤Issue

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªé‡æ„åçš„ç‰ˆæœ¬ï¼Œé‡‡ç”¨äº†æºç é›†æˆçš„MCPæœåŠ¡å™¨æ¶æ„ï¼Œæ— å¤–éƒ¨npmä¾èµ–ï¼Œæ›´é€‚åˆç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ã€‚
```

ç”Ÿäº§æ¨¡å¼ï¼š
```bash
npm start
```

## APIç«¯ç‚¹

- `GET /health`: å¥åº·æ£€æŸ¥ï¼Œè¿”å›æœåŠ¡çŠ¶æ€
- `POST /chat`: èŠå¤©æ¥å£
  - è¯·æ±‚ä½“: `{ "message": "ç”¨æˆ·é—®é¢˜" }`
  - å“åº”: `{ "text": "AIå›å¤" }`

## ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’

1. å®ç°ä¸MCP Serverçš„å­è¿›ç¨‹é€šä¿¡
2. é›†æˆLangChain.jså’ŒOpenAI API
3. å®ç°å·¥å…·è°ƒç”¨é€»è¾‘
4. å®ç°åŸºäºå·¥å…·ç»“æœçš„å›å¤ç”Ÿæˆ 
# 功能1测试指南：细化MCP工具功能

## 测试概述

功能1已完成实现，现在可以进行全面测试。新功能包含7个细化的MCP工具，支持精确获取候选人信息的不同部分，并且已经集成了最新的项目信息（包括AI候选人BFF系统项目）。

## 测试文件说明

### 1. 基础验证测试
```bash
# 验证配置和数据加载
node ai-candidate-bff/simple-test.js
```
- 验证候选人配置是否正确加载
- 检查简历JSON格式是否有效
- 确认数据结构完整性

### 2. MCP工具功能测试
```bash
# 测试所有细化的MCP工具
node ai-candidate-bff/verify-updated-tools.js
```
- 测试7个细化工具的数据获取
- 验证新项目信息是否正确集成
- 检查工具返回的数据格式

### 3. LLM集成测试
```bash
# 测试LLM服务中的工具调用
node ai-candidate-bff/test-new-project-queries.js
```
- 测试AI对新项目信息的理解
- 验证工具选择策略是否正确
- 检查语义匹配改进效果

### 4. 交互式测试服务器
```bash
# 启动测试服务器
node ai-candidate-bff/start-test-server.js
```
- 提供HTTP接口进行交互式测试
- 支持实时查询和响应时间监控
- 便于手动测试各种查询场景

## 重点测试场景

### 1. 新项目信息验证
测试查询：
- "候选人做过哪些个人项目？"
- "介绍一下AI候选人BFF系统项目"
- "候选人有MCP协议相关的经验吗？"

**预期结果**：
- 应该能找到4个个人项目（包括新的AI候选人BFF系统）
- AI候选人BFF项目应包含完整的技术栈和项目详情
- 应该正确识别MCP协议相关经验

### 2. 语义匹配测试
测试查询：
- "候选人的教育背景是什么？" vs "候选人的学历如何？"
- "候选人有哪些技能？" vs "候选人的技术能力如何？"
- "候选人做过什么项目？" vs "介绍一下候选人的项目经验"

**预期结果**：
- 千问模型应该能正确识别同义词
- 应该调用对应的细化工具而不是完整简历工具
- 响应应该更快且更精确

### 3. Token消耗优化验证
对比测试：
- 使用细化工具 vs 使用完整简历工具
- 监控LangFuse中的token使用情况

**预期结果**：
- 细化工具的token消耗应减少60-80%
- 响应时间应有明显改善
- 工具调用应更精确

## 测试命令示例

### 使用curl测试服务器
```bash
# 启动测试服务器
node ai-candidate-bff/start-test-server.js

# 在另一个终端中测试
# 1. 健康检查
curl http://localhost:3000/health

# 2. 获取工具列表
curl http://localhost:3000/tools

# 3. 测试个人项目查询
curl -X POST http://localhost:3000/test-query \
  -H "Content-Type: application/json" \
  -d '{"query": "候选人做过哪些个人项目？"}'

# 4. 测试新项目相关查询
curl -X POST http://localhost:3000/test-query \
  -H "Content-Type: application/json" \
  -d '{"query": "介绍一下AI候选人BFF系统项目"}'

# 5. 测试技能查询
curl -X POST http://localhost:3000/test-query \
  -H "Content-Type: application/json" \
  -d '{"query": "候选人有哪些技术能力？"}'
```

## 验证检查清单

### ✅ 数据完整性
- [ ] 新的AI候选人BFF项目信息已正确加载
- [ ] 所有7个细化工具都能正常工作
- [ ] 工具返回的数据格式正确
- [ ] JSON解析无错误

### ✅ 功能正确性
- [ ] AI能正确识别和调用细化工具
- [ ] 语义匹配改进生效（特别是千问模型）
- [ ] 工具选择策略按预期工作
- [ ] 新项目信息能被正确提取和展示

### ✅ 性能优化
- [ ] Token消耗明显减少
- [ ] 响应时间有改善
- [ ] LangFuse监控数据正常
- [ ] 工具调用更精确

### ✅ 兼容性
- [ ] 原有功能保持正常
- [ ] 完整简历工具仍可作为备用
- [ ] API接口向后兼容
- [ ] 部署配置无需修改

## 问题排查

### 常见问题
1. **Node.js无法运行**
   - 检查Node.js是否正确安装
   - 确认在正确的目录中运行命令

2. **依赖缺失错误**
   - 运行 `npm install` 安装依赖
   - 检查package.json和package-lock.json同步

3. **AI API调用失败**
   - 检查.env文件中的API密钥配置
   - 确认网络连接正常
   - 验证AI提供商配置

4. **工具调用异常**
   - 检查简历JSON格式是否正确
   - 验证MCP服务配置
   - 查看控制台错误日志

## 下一步

测试完成后，可以：
1. 部署到生产环境验证
2. 开始功能2（对话历史功能）的开发
3. 收集用户反馈进行进一步优化

## 测试报告模板

```
功能1测试报告
================

测试时间：[日期时间]
测试环境：[环境信息]

基础功能测试：
- 配置加载：✅/❌
- 工具功能：✅/❌
- 数据完整性：✅/❌

性能测试：
- Token消耗优化：✅/❌ (减少X%)
- 响应时间：✅/❌ (改善Xms)
- 工具调用精确性：✅/❌

新功能验证：
- AI候选人BFF项目信息：✅/❌
- 语义匹配改进：✅/❌
- 细化工具调用：✅/❌

问题记录：
[记录发现的问题]

总体评估：
[功能是否达到预期目标] 